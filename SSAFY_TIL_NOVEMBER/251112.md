## 251112

### [Objectives_ 학습 목표]

- REST API의 개념과 구성 요소(URI, Method, 표현 방식)를 이해할 수 있음
- HTTP 요청 방식(GET, POST, PUT, DELETE)의 역할을 설명할 수 있음
- Django REST Framework를 이용해 간단한 API 서버를 구축할 수 있음
- ModelSerializer를 사용하여 데이터를 JSON으로 변환하고 응답할 수 있음
- API 요청에 따른 응답 코드를 이해하고 적절하게 처리할 수 있음
- Postman을 이용해 API 서버를 테스트하고 응답 결과를 확인할 수 있음
- partial 인자 사용 등 실제 API 수정 요청에서 발생할 수 있는 상황을 처리할 수 있음

---

### [Build_ 이론]

### API_ Application Programming Interface

: 두 소프트웨어가 서로 통신할 수 있게 하는 메커니즘

: 클라이언트-서버처럼 서로 다른 프로그램에서 요청과 응답을 받을 수 있도록 만든 체계

→ 하나의 프로그램이 다른 프로그램에게 정보를 보내거나 요청할 때, 서로 이해할 수 있는 공통된 규칙과 형식이 필요함 ⇒ 이 역할을 하는 것이 **API**

**API 예시_ 날씨 데이터 받기**

![image.png](attachment:3b13f5f4-5ba2-4283-a0ee-c6010626a911:image.png)

- 기상 데이터가 들어있는 기상청의 서버
- 스마트폰의 날씨 앱, 웹 사이트의 날씨 정보 등 다양한 서버들이 이 기상청 서버에 데이터를 요청보내고 응답 받음
- 날씨 데이터를 얻으려면?
    
    ![image.png](attachment:b6f6b724-fc2c-479f-a812-fe3cc4458ebd:image.png)
    
    - 기상청 서버에는 날씨 정보를 얻고 싶으면 이런 식으로 요청해야 한다는 지정된 형식들이 작성되어 있음
    - 지역, 날짜, 조회할 내용들(온도, 바람 등)을 제공하는 매뉴얼
    
    ![image.png](attachment:a05a2e6a-8d85-4457-8379-e66916ddea7d:image.png)
    
- 소프트웨어와 소프트웨어 간 지정된 정의(형식)으로 소통하는 수단 → API
    - “이렇게 요청을 보내면, 이렇게 정보를 제공해 줄 것이다”라는 매뉴얼

→ 스마트폰의 날씨 앱은 기상청에서 제공하는 API를 통해 기상청 시스템과 대화하여 매일 최신 날씨 정보를 표시할 수 있음

**API 역할**

- 예를 들어 냉장고에 전기를 공급해야 한다고 가정
- 우리는 그냥 냉장고의 플러그를 소켓에 꽂으면 제품이 작동함
- 중요한 것은 우리가 가전 제품에 “전기를 공급하기 위해 직접 배선을 하지 않는다”는 것임
- 이는 매우 위험하면서도 비효율적인 일이기 때문임

→ 복잡한 코드를 추상화하여 대신 사용할 수 있는 몇 가지 더 쉬운 구문을 제공

**Web API**

- 웹 서버 또는 웹 브라우저를 위한 API
- 현대 웹 개발은 하나부터 열까지 직접 개발하기 보다는 여러 Open API들을 활용
- 대표적인 Third Party Open API 서비스 목록
    - Youtube API
    - Google Map API
    - Naver Papago API
    - Kakao Map API

### REST API_ Representational State Transfer API

: API Server를 개발하기 위한 일종의 소프트웨어 설계 방법론

**RESTful API :** “자원을 정의”하고 “자원에 대한 주소를 지정”하는 전반적인 방법을 서술

→ REST 원리를 따르는 시스템을 RESTful하다고 부름

→ “각각 API 서버 구조를 작성하는 모습이 너무 다르니 어느정도 약속을 만들어서 다같이 통일해서 쓰자!”

**REST API 실제 활용 예시**

![image.png](attachment:d1cfb89b-5a57-41da-86d4-28bb0de95fde:image.png)

→ REST API는 시스템 간 표준화된 통신 구조를 제공함으로써, 서로 다른 기술 스택 간에도 연동이 가능함

**REST에서 자원을 정의하고 주소를 지정하는 방법**

- 자원의 “식별”
    
    : URI
    
- 자원의 “행위”
    
    : HTTP Methods
    
- 자원의 “표현”
    
    : JSON 데이터(궁극적으로 표현되는 데이터 결과물)
    

※ URL만 보고도 무슨 데이터를 어떤 방식으로 처리할 지 예측할 수 있어야 함

→ 개발 시에는 항상 “자원 중심 + 동작 명확화 + 일관된 응답 포맷”을 기준으로 설계

### 자원의 식별

**URI_ Uniform Resource Identifier(통합 자원 식별자)**

: 인터넷에서 리소스(자원)를 식별하는 문자열

→ 가장 일반적인 URI는 웹 주소로 알려진 URL

**URL_ Uniform Resource Locator(통합 자원 위치)**

: 웹에서 주어진 리소스의 주소

→ 네트워크 상에 리소스가 어디 있는 지를 알려주기 위한 약속

![image.png](attachment:d05ca09a-21b3-413b-917c-06b711d16e2d:image.png)

**Schema(or Protocol)**

- 브라우저가 리소스를 요청하는 데 사용해야 하는 규약
- URL의 첫 부분은 브라우저가 어떤 규약을 사용하는지를 나타냄
- 기본적으로 웹은 http(s)를 요구
    - 메일을 열기 위한 mailto:, 파일을 전송하기 위한 ftp: 등 다른 프로토콜도 존재
    
    ![image.png](attachment:42c11242-f936-4b2d-8c6f-c8723ca8159e:image.png)
    

**Domain Name**

- 요청 중인 웹 서버를 나타냄
- 어떤 웹 서버가 요구되는 지를 가리키며 직접 IP 주소를 사용하는 것도 가능하지만, 사람이 외우기 어렵기 때문에 주로 Domain Name으로 사용
- ex : 도메인 google.com의 IP 주소는 142.251.42.142
    
    ![image.png](attachment:552157c9-18a5-4308-88b5-e61a98556b39:image.png)
    

**Port**

- 웹 서버의 리소스에 접근하는데 사용되는 기술적인 문(Gate)
- HTTP 프로토콜의 표준 포트
    - HTTP - 80
    - HTTPS - 443
- 표준 포트만 작성 시 생략 가능
    
    ![image.png](attachment:c9341d87-2f96-467e-964e-db92ccbd741b:image.png)
    

**Path**

- 웹 서버의 리소스 경로
- 초기에는 실제 파일이 위치한 물리적 위치를 나타냈지만, 오늘 날은 실제 위치가 아닌 추상화된 형태의 구조를 표현
- ex : /articles/create/라는 주소가 실제 articles 폴더 안에 create 폴더 안을 나타내는 것은 아님
    
    ![image.png](attachment:ed2beae0-9b82-4091-b85c-e4673de80387:image.png)
    

**Parameters**

- 웹 서버에 제공하는 추가적인 데이터
- ‘&’ 기호로 구분되는 key-value 쌍 목록
- 서버는 리소스를 응답하기 전에 이러한 파라미터를 사용하여 추가 작업을 수행할 수 있음ㅇ
    
    ![image.png](attachment:c9e9a31d-93db-479d-8d49-8270f43d0d3c:image.png)
    

**Anchor**

- 일종의 “북마크”를 나타내며 브라우저에 해당 지점에 있는 콘텐츠를 표시
- ‘#’(fragment identifier, 부분 식별자) 이후 부분은 서버에 전송되지 않음
- https://docs.djangoproject.com/en/4.2/intro/install/#quick-install-guide 요청에서 #quick-install-guide는 서버에 전달되지 않고 브라우저에게 해당 지점으로 이동할 수 있도록 함

![image.png](attachment:dbf05e20-1990-4315-b0d9-c7bc848b7178:image.png)

### 자원의 행위

**HTTP Request Methods**

: 리소스에 대한 행위, 수행하고자 하는 동작을 정의

**HTTP Request Methods 종류**

- GET
    - 서버에 리소스의 표현을 요청
    - GET을 사용하는 요청은 데이터만 검색해야 함
        
        ex) “보낸 물건 도착했나요?”
        
- POST
    - 데이터를 지정된 리소스에 제출
    - 서버의 상태를 변경
        
        ex) “이 주소로 물건 좀 보내주세요”
        
- PUT
    - 요청한 주소의 리소스를 수정
        
        ex) “받는 사람 전화번호 바뀌었어요”
        
- DELETE
    - 지정된 리소스를 삭제
        
        ex) “그 물건 취소할게요”
        

**status code_ HTTP response status codes**

: 특정 HTTP 요청이 성공적으로 완료되었는지 여부를 나타냄

→ 클라이언트가 서버에 요청을 보내면, 서버는 요청이 성공했는지 실패했는지를 숫자로 알려줌

→ 클라이언트는 이 코드를 보고 어떤 일이 일어났는지 판단할 수 있음

**HTTP response status codes**

- Informational responses(100-199)
    - 요청을 계속 진행 중이라는 중간 응답
- Successful responses(200-299)
    - 요청이 정상적으로 처리되었음을 의미
- Redirection messages(300-399)
    - 요청한 리소스가 다른 위치로 옮겨졌을 때 사용
- Client error responses(400-499)
    - 클라이언트 요청에 문제가 있을 때 반환
- Server error responses(500-599)
    - 서버 내부의 문제로 요청을 처리하지 못했을 때 사용

### 자원의 표현

**그동안 서버가 응답(자원을 표현)했던 것**

- 지금까지 Django 서버는 사용자에게 페이지(html)만 응답하고 있었음
- 서버가 응답할 수 있는 것은 페이지 뿐만 아니라 다양한 데이터 타입을 응답할 수 있음
- REST API는 이 중에서도 JSON 타입으로 응답하는 것을 권장
- JSON은 데이터만을 전달하기 위한 최소한의 형식
- 어떤 클라이언트와도 언어와 플랫폼에 독립적으로 통신할 수 있게 해줌

**응답 데이터 타입의 변화**

- 페이지(html)만을 응답하는 서버
    
    ![image.png](attachment:944ea9a0-c28b-41b2-a636-e37ecf68695b:image.png)
    
    - 사용자가 웹 브라우저를 통해 요청하면, 서버는 템플릿을 렌더링한 HTML을 반환
- 이제는 JSON 데이터를 응답하는 REST API 서버로의 변환
    
    ![image.png](attachment:131e3fac-348e-431c-8569-df6cb5340c7e:image.png)
    
    - 서버는 HTML 페이지를 만들지 않고, JSON 데이터만 응답하는 방식으로 동작할 수 있음
    - HTML 대신 JSON만 전달하므로, 응답 용량이 줄고 처리 속도가 빨라짐
- Django는 더 이상 Template 부분에 대한 역할을 담당하지 않게 되며, Front-end와 Back-end가 분리되어 구성됨
    
    ![image.png](attachment:8bc3675b-560c-43b2-aab0-9534e54d75c1:image.png)
    
    - 전통적 Django 앱 구조 → 현대적 분리 구조로의 전환 의미
- 이제부터 Django를 사용해 RESTful API 서버를 구축할 것
    
    ![image.png](attachment:65b75614-dbcb-46a6-89c6-1f7ad21d26d0:image.png)
    

### JSON 데이터 응답

**사전 준비**

- 사전 제공된 99-json-response-practice 기반 시작
- 가상 환경 생성, 활성화 및 패키지 설치
    
    ![image.png](attachment:61f4067f-d239-4a0b-aae6-3358bc28256a:image.png)
    
- migrate 진행
    
    ![image.png](attachment:d6d6bbec-5436-4586-8c0c-5ccfc715fbe0:image.png)
    
- 준비된 fixtures 파일을 load하여 실습용 초기 데이터 입력
    
    ![image.png](attachment:d96cb7bf-fd76-4ce1-9076-43f10d47d526:image.png)
    
- 서버 실행
    
    ![image.png](attachment:d7e9377b-3950-440f-81ea-e4a5e3cae1d0:image.png)
    
- 터미널 분할(별도의 파이썬 코드를 실행하기 위함)
    
    ![image.png](attachment:9810d6d5-566a-4112-a326-be37050d8e8f:image.png)
    
- http://127.0.0.1.:8000/api/v1/articles/ 요청 후 응답 확인
    
    ![image.png](attachment:15fc40ec-0698-4986-90c1-295d6c19183d:image.png)
    

**python으로 json 데이터 처리하기**

- 준비된 [python-reqeust-sample.py](http://python-reqeust-sample.py) 확인
    
    ![image.png](attachment:2bca97a8-1846-4edf-b867-7d8208fac157:image.png)
    
- 서버가 실행되어 있는 상태에서 2번째 터미널에서 코드 실행
    
    ![image.png](attachment:28551553-2a8b-48ec-b7cf-b35c0957482b:image.png)
    

### DFR with Single Model

### Django REST Framework

: Django에서 Restful API 서버를 쉽게 구축할 수 있도록 도와주는 오픈소스 라이브러리

**프로젝트 준비**

- 사전 제공된 drf 프로젝트 기반 시작
- 가상환경 생성, 활성화 및 패키지 설치
- migrate 진행
    
    ![image.png](attachment:94d0de50-340d-48f7-8c2b-e426b8f5385b:image.png)
    
- 준비된 fixtures 파일을 load하여 실습용 초기 데이터 입력
    
    ![image.png](attachment:78179c60-a563-42ba-bf98-a16714540f22:image.png)
    

**Postman 설치 및 안내**

- https://www.postman.com/downloads/
    
    ![image.png](attachment:26777341-b8b9-4412-bd45-d6e21cde40b4:image.png)
    
    ![image.png](attachment:b4db15e4-0015-40de-a9d7-e6aa90bb1e6e:image.png)
    
- Postman 화면 구성
    
    ![image.png](attachment:aedaf65d-eb07-4787-adc7-4164b1e1cd84:image.png)