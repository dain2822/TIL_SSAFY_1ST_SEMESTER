## 250919

### [Objectives_ 학습 목표]

- Django Template system을 활용할 수 있음
- Django Template system을 활용하여 HTML의 내용을 데이터에 따라 바꿀 수 있음
- HTML form을 활용해 요청을 보낼 수 있음
- URL의 일부분을 변수로 활용할 수 있음
- 다수의 앱의 URL을 효율적으로 관리할 수 있음
- URL이 변할 수 있는 상황에 대해 유연하게 대처하는 방법을 배움

---

### [Build_ 이론]

### Django Template System

: 파이썬 데이터(context)를 HTML 문서(Template)와 결합하여, 로직과 표현을 분리한 채 동적인 웹페이지를 생성하는 도구

→ 뉴스 사이트의 모든 기사는 헤더, 폰트, 광고 위치 등 동일하 페이지 틀(Template)을 공유하지만 각 페이지에 들어가는 데이터(Context), 즉 기사 제목, 내용, 기자 이름은 모두 다름

**HTML의 콘텐츠를 변수 값에 따라 변경하기**

![image.png](attachment:4010c75f-b207-4953-b493-d4cf1fb5f260:image.png)

![image.png](attachment:e0b6c4cc-ce3b-459a-b617-7a4fc67c2160:image.png)

→ context[’name’]이 변경되면 응답 받은 HTML의 모습도 변경됨

**Django Template System의 목적**

: ‘페이지 틀’에 ‘데이터’를 동적으로 결합하여 수많은 페이지를 효율적으로 만들어 내기 위함

### **Django Template Language_ DTL**

: Template에서 조건, 반복, 변수 등의 프로그래밍적 기능을 제공하는 시스템

**DTL Syntax**

1. Variable
    
    ![image.png](attachment:9fcd746b-85cb-46fd-8230-7e5874a917a6:image.png)
    
    ![image.png](attachment:348b04f4-fbe3-4fa6-a436-35ce63f3ce06:image.png)
    
    - Django Template에서의 변수
    - render 함수의 세번째 인자로 딕셔너리 타입으로 전달됨
    - 해당 딕셔너리 key에 해당하는 문자열이 template에서 사용 가능한 변수명이 됨
    - dot(’.’)을 사용하여 변수 속성에 접근할 수 있음

![image.png](attachment:46f91020-bad4-4943-a79b-cde4d570e04a:image.png)

1. Filters
    
    ![image.png](attachment:a1bc38b7-08f1-4457-bc81-c3400f0682d6:image.png)
    
    ![image.png](attachment:aee6605e-9412-40cb-aa60-9d8927195973:image.png)
    
    - 표시할 변수를 수정할 때 사용(변수 + ‘|’ + 필터)
    - chained(연결)이 가능하며 일부 필터는 인자를 받기도 함
    - 약 60개의 built-in template filters를 제공
2. Tags
    
    ![image.png](attachment:300b4786-b875-460f-b726-6f2dfd24309f:image.png)
    
    ![image.png](attachment:3becfe58-1d1c-49aa-b9aa-182d72339e53:image.png)
    
    - 반복 또는 논리를 수행하여 제어 흐름을 만듦
    - 일부 태그는 시작과 종료 태그가 필요
    - 약 24개의 built-in template tags를 제공
    - if, else, endif 태그
        
        ![image.png](attachment:9951fec8-8190-4688-a4c9-43e66dd96f3f:image.png)
        
    - for 태그
        
        ![image.png](attachment:2fc90d1c-8ec5-462c-9e59-c5e4b7ce6fe9:image.png)
        
3. Comments
    - 주석
        - inline
            
            ![image.png](attachment:468c2a95-2234-4bec-a727-9edf122e72a6:image.png)
            
        - multiline
            
            ![image.png](attachment:918d0214-173e-47e2-ba41-330ae482b007:image.png)
            

---

### 템플릿 상속_ Template Inheritance

1. 페이지의 공통 요소를 포함
2. 하위 템플릿이 재정의 할 수 있는 공간을 정의

→ 여러 템플릿이 공통 요소를 공유할 수 있게 해주는 기능

**상속 구조 만들기**

- skeleton 역할을 하게 되는 상위 템플릿(base.html) 작성
    - 모든 템플릿이 공유했으면 좋겠는 공통요소를 작성
    - 템플릿 별로 재정의할 부분은 block 태그를 활용
    
    ![image.png](attachment:28472f2a-dd20-4ffc-9e74-534dfec8719d:image.png)
    
- 기본 하위 템플릿들이 상위 템플릿을 상속받도록 변경
    - extends 태그로 상속받을 템플릿 결정
    - block 태그를 활용해 base.html의 같은 이름으로 작성된 block 태그의 내용을 대체
    
    ![image.png](attachment:723659d0-d510-4def-b6f3-0a1e332482a5:image.png)
    
- 최종 형태

![image.png](attachment:64a4f406-b38e-43dd-a0c7-87da80af7a37:image.png)

### 상속 관련 DTL 태그

- ‘extends’ tag
    
    `{% extends ‘articles/base.html’ %}`
    
    - 자식(하위) 템플릿이 부모 템플릿을 확장한다는 것을 알림
    - 반드시 자식 템플릿 **최상단**에 작성되어야 함
    - extends 태그는 **2개 이상 사용 불가함**
- ‘block’ tag
    
    `{% block ‘content’ %} {% endblock ‘content’ %}`
    
    - 하위 템플릿에서 재정의 할 수 있는 블록을 정의
    - 상위 템플릿에서 작성하며 하위 템플릿이 작성할 수 잇는 공간을 지정하는 것

![image.png](attachment:44c28d23-9256-484c-845c-7e24b45b5aaf:image.png)

→ 하위 템플릿의 block이 상위 템플릿의 block의 내용을 대체하게 됨

---

### HTML form

: HTTP 요청을 서버에 보내는 가장 편리한 방법

![image.png](attachment:6ff47cae-63c2-475c-a1c7-71b57079a506:image.png)

![image.png](attachment:05467e24-b80f-4e2b-803e-a93a02e18030:image.png)

![image.png](attachment:9180de99-b54e-438c-9496-8715a404497b:image.png)

**데이터를 보내고 가져오기_ Sending and Retrieving form data**

: HTML ‘form’ element를 통해 사용자와 애플리케이션 간의 상호작용 이해하기

**’form’ element**

: 사용자로부터 할당된 데이터를 서버로 전송하는 HTML 요소

→ 웹에서 사용자 정보를 입력하는 여러 방식(text, password, checkbox 등)을 제공

**HTML form 핵심 속성**

- action & method
    
    : form의 핵심 속성 2가지
    
    : 데이터를 어디(action)로 어떤 방식(method)으로 요청할 지
    
    ![image.png](attachment:e3d17b3d-ef5b-46a7-ae2d-fae4c3b481de:image.png)
    
    - action
        
        : 입력 데이터가 전송될 URL을 지정(목적지)
        
        → actions을 지정하지 않으면 데이터는 현재 페이지의 URL로 설정됨
        
    - method
        
        : 데이터를 어떤 방식으로 보낼 것인지 정의
        
        : 데이터의 HTTP request method(GET, POST)를 지정
        
- ‘input’ element
    
    : 사용자의 데이터를 입력 받을 수 있는 HTML 요소
    
    : type 속성 값에 따라 다양한 유형의 입력 데이터를 받음
    
    → 핵심 속성 : ‘name’
    
- ‘name’ attribute
    
    ![image.png](attachment:2dcf7729-f070-4e81-8904-7e517e76e60a:image.png)
    
    : input 요소의 핵심 속성
    
    : 사용자가 입력한 데이터에 붙이는 이름(key)
    
    : 데이터를 제출했을 때 서버는 name 속성에 설정된 값을 통해서만 사용자가 입력한 데이터에 접근할 수 있음
    
- Query String Parameters
    
    : 사용자의 입력 데이터를 URL 주소에 파라미터를 통해 서버로 보내는 방법
    
    : 문자열은 앰퍼센트(’&’)로 연결된 key=value 쌍으로 구성되며, 기본 URL과는 물음표(’?’)로 구분됨
    
    ex) `http://host:port/path?key=value&key=value`
    

**HTML form 활용**

- HTTP request 객체
    
    : form으로 전송한 데이터 뿐만 아니라 Django로 들어오는 모든 요청 관련 데이터가 담겨 있음
    
    → view 함수가 호출될 때 첫 번째 인자로 전달됨
    
    ![image.png](attachment:be90e778-6c3d-498c-8d3f-6980cbe089fb:image.png)
    
- request 객체에서 form 데이터 추출
    
    : request.GET에 작성한 message가 담겨있음을 확인할 수 있음
    
    ![image.png](attachment:b7e18402-a66c-4cc4-8cdb-f2f8522cda54:image.png)
    
- throw - catch 간 요청과 응답 정리
    - 브라우저에 http://127.0.0.1:8000/throw/를 입력하면 발생하는 일
    
    ![image.png](attachment:6e96b932-e408-4743-b67d-ba8d78cb1820:image.png)
    
    - throw 페이지에서 일어나는 일
    
    ![image.png](attachment:d2429c90-65f3-4bfd-bb4b-d5516b904808:image.png)
    

---

### Django URLs

**요청과 응답에서 Django URLs의 역할**

- 요청 URL에 따라 실행될 view 함수가 달라짐

![image.png](attachment:5474e95e-ecc0-468b-95f9-1be14deb1d17:image.png)

- URL dispatcher_ 운항 관리자, 분배기
    
    : URL 패턴을 정의하고 해당 패턴이 일치하는 요청을 처리할 view 함수를 연결(매핑)
    

**Variable Routing**

- 현재 URL 관리의 문제점
    
    → 템플릿의 많은 부분이 중복되고, URL의 일부만 변경되는 상황이라면?
    
    → 계속해서 비슷한 URL과 템플릿을 작성해 나가야 할까?
    
    ![image.png](attachment:456c183c-200f-4e47-b937-48b393b154fa:image.png)
    
- URL 일부에 변수를 포함시키는 것
    
    ![image.png](attachment:8e34d487-5c88-4dfe-8676-0e03ad58049c:image.png)
    
    : 변수는 view 함수의 인자로 전달할 수 있음
    
- 요청 URL의 <int:num>, <str:name>의 위치에 들어있는 값이 변수처럼 취급됨
    - 정수 num 변수가 views.detail에 문자열 name 변수가 views.greeting에 키워드 인자로 전달됨
    - ex) 요청 URL이 /articles/10/ 이면, views.detail(request, num=10)의 형태로 호출
- Path Converter
    - URL 변수의 타입을 지정
    - str, int 등 5가지 타입 지

![image.png](attachment:8a13d943-a275-4a8b-b1f3-f7ec91ed47e8:image.png)

- Variable Routing 실습

![image.png](attachment:266c0caf-46cf-481c-a0ea-4be4f8917bc6:image.png)

→ Path Converter의 변수명과 View 함수의 파라미터 이름은 같아야 함

![image.png](attachment:79dc2625-b4e3-48b3-8ef9-8e00d90d98ed:image.png)

![image.png](attachment:823da974-859c-4bd7-9a27-77efc622afad:image.png)

![image.png](attachment:61afc240-5d34-4976-825f-b383881cc65c:image.png)

### APP URL 정의

**App URL mapping**

: 각 앱에 URL을 정의하는 것

: 프로젝트와 각 앱이 URL을 나누어 관리를 편하게 하기 위함

→ 현재는 앱이 하나 밖에 없지만, 앱이 늘어나게 되면 서로 다른 앱의 URL들이 섞이지 않도록 나누어 관리하는 방법

- 기존 URL 구조_ 프로젝트 urls.py에 모든 URL이 담겨있음

![image.png](attachment:3c7275fe-7b6d-4b84-8d9f-cd87766e84d7:image.png)

- 변경된 URL 구조_ 각 앱의 urls.py에서 각자의 URL 관리

![image.png](attachment:9f86ed93-0180-407b-b19a-225dfda3a635:image.png)

- include 함수
    
    ![image.png](attachment:b86bd0eb-f04d-4924-b6d7-ee6f5791bade:image.png)
    
    : 프로젝트 내부 앱들의 URL을 참조할 수 있도록 매핑하는 함수
    
    → URL의 일치하는 부분까지 잘라내고, 남은 문자열 부분은 후속 처리를 위해 include된 URL로 전달
    
    - 각 앱에서 urls.py를 만들고
        
        ![image.png](attachment:7e7c94d8-4c4a-4500-be0f-e48b12e434ca:image.png)
        
    - 프로젝트 urls.py에서 include()로 추가
        
        ![image.png](attachment:9037e559-2dbf-4757-a740-b8b22c7abef4:image.png)
        
    - 요청 URL이 http://127.0.0.1:8000/articles/index/일 때
        - firstpjt/urls.py에서 articles/까지 일치한 뒤  articles/urls.py에서 나머지 index/를 찾음
        
        ![image.png](attachment:10a70b94-7387-4c22-afb4-67752757afbe:image.png)
        

**URL 구조 변화**

- URL 이동

![image.png](attachment:03ac74f8-0d43-43db-8b24-a015549e0899:image.png)

- 주석 정리

![image.png](attachment:038c22ed-102b-4079-8149-b0cbd1a30550:image.png)

---

### Naming URL Patterns

**URL 구조 변경에 따른 문제점**

- 기존 ‘articles/’ 주소가 ‘articles/index/’로 변경됨에 따라 해당 URL을 사용하는 모든 위치를 찾아가 변경해야 함

![image.png](attachment:51c6f28e-5d98-4fd2-aa2c-4fbea587a684:image.png)

- 기존 ‘articles/’ 주소가 ‘articles/index/’로 변경됨에 따라 해당 URL을 사용하는 모든 위치를 찾아가 변경해야 함

![image.png](attachment:ccc16fe6-83fe-4089-8548-b475a8dcae83:image.png)

- URL에 이름을 지정하는 것
    
    : path 함수에 name 인자를 키워드 인자로 정의해서 사용
    
    ![image.png](attachment:e686bfc7-b4e7-4655-be8a-612d0682086a:image.png)
    

**URL 표기 변화**

- 해당 url을 사용했던 곳의 링크 변경
    - 새로운 articles/urls.py
        
        ![image.png](attachment:e733ce46-be62-48b1-8a20-4aa98c84ada8:image.png)
        
        → a 태그의 href 속성 값 뿐만 아니라 form의 action 속성 등도 변경해야 함
        
    - articles/index.html 변화
        
        ![image.png](attachment:b6c3535d-1832-4551-b7f6-9beca0026ab7:image.png)
        
- 브라우저 상의 실제 링크 확인
    
    ![image.png](attachment:ae9cfb15-c1db-422f-9d30-9dcc9d35e447:image.png)
    

---

### DTL URL tag

**’url’ tag**

![image.png](attachment:52f69a26-71c4-4cca-a2f2-cb51af367bd7:image.png)

: 주어진 URL 패턴의 이름과 일치하는 절대 경로 주소를 반환

→ URL에 이름을 붙였을 경우 url 태그와 이름을 이용해 템플릿 상에ㄴㄴ서 이름을 실제 주소를 작성할 수 있게 해줌

1. 주어진 URL 패턴의 이름과 일치하는 절대 경로 주소를 반환
    
    ![image.png](attachment:104452e7-3d15-4e05-8ee7-4320fd0c35b9:image.png)
    
2. URL 패턴에 변수가 포함되어 있으면, ‘url_name’ 이후 추가
    
    ![image.png](attachment:64bca1fb-44c4-4a29-992e-45f2bcc9dfc5:image.png)
    
3. DTL의 for 태그에서 사용한 변수 이름 사용 가능

![image.png](attachment:78feea2e-e27b-47ce-aaf8-5f216d79a255:image.png)

---

### app_name 속성

**URL 이름 지정 후 남은 문제**

- articles 앱의 url 이름과 pages 앱의 url 이름이 같은 상황
- 단순히 이름만으로는 완벽하게 분리할 수 없음
    - articles와 pages 모두 index가 있음
    
    ![image.png](attachment:66f3f97c-abc0-434c-ab3c-74f767175d99:image.png)
    

**’app_name’ 속성 지정**

1. urls.py에 app_name 변수 설정
    
    ![image.png](attachment:48e21e35-c5aa-4b0b-9030-d25d53f972fd:image.png)
    
2. app_name이 추가 또는 수정되면 url 태그에도 해당 내용이 반영되어야 함
    
    ![image.png](attachment:98793080-84cb-4103-9594-1f137a1924d9:image.png)
    
3. HTML 반영 후 확인
    
    ![image.png](attachment:2bb97bb1-4259-48d1-be06-c5caaf0193db:image.png)
    

⇒ 최종 링크는 변하지 않음

![image.png](attachment:2cda2ac1-6d19-4369-8daa-7fa65731925f:image.png)